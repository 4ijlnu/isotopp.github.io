<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Die wunderbare Welt von Isotopp - Was bedeutet eigentlich &#39;Relationale Algebra&#39;?</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="site.webmanifest">
<link rel="apple-touch-icon" href="icon.png">
<link rel="favicon.ico" rel="icon" type="image/ico">





	



<link rel="stylesheet" href="/style.min.c5e5cd61f54911f9aafd1dbe09c2f90667957bfe1002126c87aace57759f3446.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
	<a class="navbar-brand" href="" rel="home" title=".Site.Title">
	    Die wunderbare Welt von Isotopp
	</a>
	<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
		
		
		<li class="nav-item ">
                    <a class="nav-link" href="/about/">
			
			<span>About</span>
			<span class="visually-hidden">(Current)</span>
		    </a>
		    
		</li>
            </ul>
            
	</div>
    </div>
</nav>


        <main role="main" class="container-fluid">

            


<div class="page">
    <article class="was-bedeutet-eigentlich-relationale-algebra-page">
	<h1 class="title">
            Was bedeutet eigentlich &lsquo;Relationale Algebra&rsquo;?
	</h1>

	<p><p class="md__image">
  <img src="/uploads/vorsicht_mathe.png" alt=""  />
</p>

</p>
<p>SQL ist eine Abfragesprache, die als mathematischen Unterbau die
Relationenalgebra hat. Was genau ist das?</p>
<p>Da ist einmal der Begriff der &ldquo;Algebra&rdquo;. In der Wikipedia findet man
<a href="http://de.wikipedia.org/wiki/Algebraische_Struktur#Variante_1" target="_blank" rel="noopener">die mathematische Definition</a>


der algebraischen Struktur, und sie ist, weil sie mathematischen Formalismen
genügen muß, für den ungeübten ein wenig unhandlich zu lesen.</p>
<p>Dort steht aber nix anderes als &lsquo;Wir haben eine Grundmenge A und einen
definierten Satz von erlaubten Operationen auf A, und wir garantieren, das
das Ergebnis jeder Operation wieder in A liegt.&rsquo; Mehr nicht. Eine Algebra
ist also eine Struktur, die Elemente enthält, mit denen man rechnen kann
(etwa die natürlichen Zahlen), und Operationen, die definieren, was erlaubte
Rechenoperationen sind (etwa die Addition). Wenn etwas eine Algebra ist,
dann heißt das, daß man mit dem Ergebnis der Operation wieder in A landet,
also mit dem Ergebnis weiter rechnen kann.</p>
<p>Die natürlichen Zahlen und die Addition sind eine Algebra.</p>
<p>Die natürlichen Zahlen und die Operationen Addition und Subtraktion sind
keine Algebra, da 4 minus 6 (4 und 6 sind natürliche Zahlen) den Wert -2
ergibt und -2 ist keine natürliche Zahl - wir haben die Grundmenge
verlassen.</p>
<p>In dem Wunsch, mit immer mehr mathematischen Operationen (Addition,
Subtraktion, Multiplikation, Division, Potenzen, Wurzeln, &hellip;) eine Algebra
zu bekommen, hat die Mathematik sich von den natürlichen über die ganzen,
die rationalen und schließlich die reellen Zahlen bis zu den komplexen
Zahlen vorgearbeitet.</p>
<p>Dann ist da dieses andere Wort: Was genau ist eine Relation?</p>
<p>Wir kennen den mathematischen Begriff der Funktion.</p>
<p>Eine Funktion bildet eine oder mehrere Mengen zur Gänze oder zum Teil auf
eine Ergebnismenge ab. Die Funktionsvorschrift sagt, wie das geht. Die
Ergebnisse kann man aufmalen, und dann bekommt man den Graphen der Funktion.
Und um uns zu verwirren, verwenden die Mathefuzzis Funktion,
Funktionsvorschrift und den Graphen der Funktion umgangssprachlich gerne mal
synonym.</p>
<p>Die Mathematiker zum Beispiel malen Geraden als Funktion von den reellen
Zahlen in die reellen Zahlen, verwenden die allgemeine Funktionsvorschrift
&ldquo;y = mx + n&rdquo; (die
<a href="http://de.wikipedia.org/wiki/Geradengleichung#Lineare_Funktionen" target="_blank" rel="noopener">Geradengleichung</a>

)
um die Gerade zu definieren und der Graph der Funktion sieht dann so aus:</p>
<p><p class="md__image">
  <img src="/uploads/funktion.png" alt=""  />
</p>

</p>
<p>Graph der Funktion y=0.5x+2. Jedem x-Wert ist genau ein y-Wert
zugeordnet.</p>
<p>Eine Funktion liefert für einen Eingangswert genau ein Ergebnis. Für den
Wert x=0 bekommen wir aus der oben aufgezeichneten Beispielfunktion den
einen Wert y=2 heraus und so weiter.</p>
<p>Eine Relation liefert statt einzelner Werte Teilmengen der Ergebnismenge.
Zeichnete man statt der Funktion y = 0.5<em>x + 2 die Relation y &gt; 0.5</em>x + 2,
dann würde man statt einer Geraden wie oben im Beispiel die Fläche über der
Geraden bekommen: Die Relation &lsquo;größer als&rsquo; liefert uns in diesem
Zusammenhang nicht einen einzelnen Wert, sondern alle Werte, die für den
gegebenen x-Wert größer als 0.5*x + 2 sind.</p>
<p><p class="md__image">
  <img src="/uploads/relation.png" alt=""  />
</p>

</p>
<p>Graph der Relation y&gt;0.5x+2. Einem x-Wert ist eine Menge von y-Werten
zugeordnet. Diese Menge von y-Werten ist eine Teilmenge der
Grundmenge.</p>
<p>Das ist genug Mathematik. Wir wollen Informatik machen.</p>
<p>Das bedeutet als erstes einmal: Weg mit den doofen Unendlichkeiten.
Komplexe, reelle, rationale, ja sogar natürliche Zahlen - das ist alles
unendliches, nicht anfaßbares Gekasper von irgendwelchen Mathespinnern. Wir
wollen Werte, die man anfassen und mit dem Debugger im Speicher sehen kann.
Informatik macht
<a href="http://de.wikipedia.org/wiki/Diskrete_Mathematik" target="_blank" rel="noopener">Diskrete Mathematik</a>

,
alles schön endlich. Da kann man eine Funktion dann auch schon mal als
Wertetabelle statt als Rechenvorschrift definieren.</p>
<p>Und so landen wir bei den Tabellen.</p>
<h2 id="grundmenge-der-relationenalgebra-tabellen">
    <a href="#grundmenge-der-relationenalgebra-tabellen">
	Grundmenge der Relationenalgebra: Tabellen
    </a>
</h2>
<p>Tabellen bestehen aus Zeilen. Eine Zeile kann eine bestimmte Menge von
Werten enthalten, aber bei einer Tabelle enthält jede Zeile gleich viele
Werte. In der Mathematik nennt man ein Konstrukt mit n Werten ein &ldquo;n-Tupel&rdquo;
und schreibt es mit runden Klammern, also (3, 4, 5) für das 3-Tupel mit den
Werten 3, 4 und 5.</p>
<p>In der Informatik gibt es zwei Lager von Leuten. Die einen wollen die
Grundmengen von Dingen immer überall vorher festgelegt haben, also statische
Typen. Die anderen wollen an jedem Wert dranstehen haben, aus welcher
Grundmenge er stammt, also dynamische Typen. Die meisten SQL-Datenbanken
wollen statische Typen, verlangen also nicht nur, daß eine Tabelle als &ldquo;Hat
3 Spalten&rdquo; definiert wird, sondern daß für jede Spalte auch ein Typ festlegt
wird: (int, char(20), double) wäre eine solche Festlegung. Von allen
SQL-Datenbanken, die ich kenne, ist nur
<a href="http://de.wikipedia.org/wiki/Sqlite" target="_blank" rel="noopener">Sqlite</a>

 dynamisch getypt.</p>
<p>Eine Algebra, wir erinnern uns, ist eine Grundmenge und ein Haufen
Operationen, und mit den Ergebnissen der Operationen wollen wir weiter
rechnen können - sie müssen also wieder in der Grundmenge liegen.</p>
<h2 id="5-operationen-der-relationenalgebra-selektion-projektion-kreuzprodukt-umbenennung-und-aggregation">
    <a href="#5-operationen-der-relationenalgebra-selektion-projektion-kreuzprodukt-umbenennung-und-aggregation">
	5 Operationen der Relationenalgebra: Selektion, Projektion, Kreuzprodukt, Umbenennung und Aggregation
    </a>
</h2>
<p>Die Elemente unserer Algebra sollen Tabellen sein, also Mengen von Tupeln: {
(1, 2, 3), (3, 4, 5), (&ldquo;keks&rdquo;, &ldquo;cookie&rdquo;, &ldquo;kex&rdquo;)} zum Beispiel. Auf dieser
Menge definieren wir nun einen Haufen Operationen. Fünf, um genau zu sein.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> a ( 
<span style="color:#f92672">-&gt;</span>  aid integer unsigned <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>
<span style="color:#f92672">-&gt;</span>) engine <span style="color:#f92672">=</span> innodb;
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">16</span> sec)

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> a (aid) <span style="color:#66d9ef">values</span> (<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">3</span>);
Query OK, <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">01</span> sec)
Records: <span style="color:#ae81ff">3</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> b (
<span style="color:#f92672">-&gt;</span>   bid integer unsigned <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>
<span style="color:#f92672">-&gt;</span> ) engine <span style="color:#f92672">=</span> innodb;
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">05</span> sec)

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> b (bid) <span style="color:#66d9ef">values</span> (<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">2</span>);
Query OK, <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
Records: <span style="color:#ae81ff">2</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>
</code></pre></div><p><p class="md__image">
  <img src="/uploads/selektion_projektion.png" alt=""  />
</p>

</p>
<p>Operation 1: Selektion, Operation 2: Projektion. Auswahl von Zeilen und
Spalten.</p>
<p>Die erste Operation ist die <strong>Selektion</strong>. Aus allen Zeilen einer Tabelle
wählt die Selektion genau die Tupel aus, für die die angegebene Bedingung,
das angegebene Prädikat, wahr ist.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> aid <span style="color:#66d9ef">from</span> a <span style="color:#66d9ef">where</span> aid <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span>;
<span style="color:#f92672">+</span><span style="color:#75715e">-----+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> aid <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Wir haben eine Relation: Die Ergebnismenge ist eine Teilmenge der
Ausgangsmenge und kann aus mehr als einem Tupel bestehen. Wir haben auch
eine Algebra, jedenfalls hinsichtlich der Selektion: Es wird eine Tabelle
zurück geliefert.</p>
<p>Die zweite Operation ist die <strong>Projektion</strong>. Aus allen Tupeln der Tabelle
werden neue Tupel berechnet. Die Abbildung kann die Identität sein (&ldquo;select
spaltenname &hellip;&quot;) oder das Ergebnis einer komplizierteren Funktion sein, die
ein oder mehr Stellen aus dem alten Tupel als Eingabeparameter nimmt
(&ldquo;select a+b &hellip;&quot;).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> aid, aid<span style="color:#f92672">*</span><span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">19</span>  <span style="color:#66d9ef">from</span> a;
<span style="color:#f92672">+</span><span style="color:#75715e">-----+----------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> aid <span style="color:#f92672">|</span> aid<span style="color:#f92672">*</span><span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">19</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+----------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">19</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">2</span>.<span style="color:#ae81ff">38</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">3</span>.<span style="color:#ae81ff">57</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+----------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p><p class="md__image">
  <img src="/uploads/a_join_b.png" alt=""  />
</p>

</p>
<p>Operation 3: Der Join (Das Kreuzprodukt).</p>
<p>Die dritte Operation ist der <strong>Join</strong> oder das <strong>Kreuzprodukt</strong>. Es
verknüpft zwei Tabellen so, daß jede Zeile aus der ersten Tabelle mit jeder
Zeile aus der zweiten Tabelle kombiniert wird.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> aid, bid <span style="color:#66d9ef">from</span> a, b;
<span style="color:#f92672">+</span><span style="color:#75715e">-----+-----+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> aid <span style="color:#f92672">|</span> bid <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+-----+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+-----+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">6</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Zusammen mit der Selektion kann man so Tabellen sinnvoll miteinander
verknüpfen (<code>select * from c, d where c.cid = d.cid</code>), und mit ein wenig
Evolution landet man dann bei der Schlüsselwort-Schreibweise von Joins (seit
1992 üblich): <code>select * from c join d on c.cid = d.cid</code>. Diese Schreibweise
macht Join-Bedingungen (ON-Clause) von einschränkenden Prädikaten
(WHERE-Clause) unterscheidbar und ist die empfohlene Schreibweise für Joins.</p>
<p><p class="md__image">
  <img src="/uploads/rename.png" alt=""  />
</p>

</p>
<p>Operation 4: Rename. Nützlich vor allen Dingen mit Self-Joins in Bäumen und
Hierarchien.</p>
<p>Die vierte Operation ist der <strong>Rename</strong> mit dem Schlüsselwort AS. Man kann
Tabellen und Spalten umbenennen. Die Rename-Operation erscheint sinnlos, ist
aber zwingend notwendig, damit man selbstreferentielle Strukturen wie Bäume
und Hierarchien abbilden kann.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> emp (
<span style="color:#f92672">-&gt;</span>   empid integer unsigned <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>, 
<span style="color:#f92672">-&gt;</span>   bossid integer unsigned <span style="color:#66d9ef">null</span>
<span style="color:#f92672">-&gt;</span> ) engine <span style="color:#f92672">=</span> innodb;
Query OK, <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">06</span> sec)

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">values</span> 
<span style="color:#f92672">-&gt;</span> ( <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">NULL</span>), 
<span style="color:#f92672">-&gt;</span> (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>), 
<span style="color:#f92672">-&gt;</span> (<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>);
Query OK, <span style="color:#ae81ff">6</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
Records: <span style="color:#ae81ff">6</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> emp <span style="color:#66d9ef">join</span> emp <span style="color:#66d9ef">on</span> emp.bossid <span style="color:#f92672">=</span> emp.empid;
ERROR <span style="color:#ae81ff">1066</span> (<span style="color:#ae81ff">42000</span>): <span style="color:#66d9ef">Not</span> <span style="color:#66d9ef">unique</span> <span style="color:#66d9ef">table</span><span style="color:#f92672">/</span><span style="color:#66d9ef">alias</span>: <span style="color:#e6db74">&#39;emp&#39;</span>

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> 
<span style="color:#f92672">-&gt;</span>    emp.empid <span style="color:#66d9ef">as</span> mitarbeiter,
<span style="color:#f92672">-&gt;</span>    <span style="color:#e6db74">&#34; hat den Boss &#34;</span>, 
<span style="color:#f92672">-&gt;</span>    boss.empid <span style="color:#66d9ef">as</span> boss 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> 
<span style="color:#f92672">-&gt;</span>     emp <span style="color:#66d9ef">as</span> boss <span style="color:#66d9ef">join</span> emp <span style="color:#66d9ef">on</span> emp.bossid <span style="color:#f92672">=</span> boss.empid;
<span style="color:#f92672">+</span><span style="color:#75715e">-------------+----------------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> mitarbeiter <span style="color:#f92672">|</span> hat den Boss   <span style="color:#f92672">|</span> boss <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------------+----------------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>           <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>  hat den Boss  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>           <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>  hat den Boss  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>           <span style="color:#ae81ff">4</span> <span style="color:#f92672">|</span>  hat den Boss  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>           <span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span>  hat den Boss  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>           <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>  hat den Boss  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------------+----------------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">5</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">34</span> sec)
</code></pre></div><p><p class="md__image">
  <img src="/uploads/group_by.png" alt=""  />
</p>

</p>
<p>Operation 5: Aggregation.</p>
<p>Und schließlich gibt es noch die <strong>Aggregation</strong>. Bei einem Aggregat hat man
ein Tupel mit n Stellen, zum Beispiel 2 Stellen und vertrachtet bei
Vergleichen nur eine Stelle, etwa die erste, um das Ergebnis in Gruppen
einzuteilen. Nehmen wir zum Beispiel noch einmal unsere Mitarbeiterliste mit
Bossen und Mitarbeitern:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> bossid, empid <span style="color:#66d9ef">from</span> emp;
<span style="color:#f92672">+</span><span style="color:#75715e">--------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> bossid <span style="color:#f92672">|</span> empid <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">4</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>     <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+-------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">6</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Hier haben wir einen Haufen 2-Tupel. Betrachten wir nur die erste Spalte,
dann haben wir eine Gruppe von Mitarbeitern, die dem Boss 1 unterstellt
sind, und eine Gruppe von Mitarbeitern, die dem Boss 2 unterstellt sind. In
SQL:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> 
<span style="color:#f92672">-&gt;</span>    emp.bossid,
<span style="color:#f92672">-&gt;</span>    <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>), 
<span style="color:#f92672">-&gt;</span>    group_concat(emp.empid) <span style="color:#66d9ef">as</span> mitarbeiter 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> 
<span style="color:#f92672">-&gt;</span>    emp 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> 
<span style="color:#f92672">-&gt;</span>    emp.bossid;
<span style="color:#f92672">+</span><span style="color:#75715e">--------+----------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> bossid <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>) <span style="color:#f92672">|</span> mitarbeiter <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+----------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>        <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>           <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>        <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>         <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>        <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+----------+-------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>GROUP BY macht genau diese Aggregation - das Einteilen in Gruppen. In einer
Query mit GROUP BY dürfen wir vorne im SELECT-Teil nur Spalten erwähnen, die
auch im GROUP BY-Teil genannt sind, und Aggregatfunktionen. COUNT ist so
eine Aggregatfunktion - sie sagt uns, wie viele Elemente denn in der Gruppe
(1, *) sind und wie viele in der Gruppe (2, *). GROUP_CONCAT ist eine
weitere Funktion. Sie nimmt die Elemente der Gruppe und macht eine
Komma-Liste daraus.</p>
<p>Damit haben wir eine Algebra mit einer Grundmenge (Tupelmengen, also
Tabellen) und fünf einfachen Operationen, die Tabellen in andere Tabellen
umwandeln.</p>
<h2 id="algebra-bedeutet-weiterrechnen-zu-können">
    <a href="#algebra-bedeutet-weiterrechnen-zu-k%c3%b6nnen">
	Algebra bedeutet: weiterrechnen zu können
    </a>
</h2>
<p>Da das ganze eine Algebra ist, heißt das: Wir können mit den Ergebnissen
einer Operation weiter Rechnen, also errechnete Tabellen in SQL-Statements
einsetzen. Dieser Mechanismus heißt in SQL <strong>Subquery</strong>: Wir können an jeder
Stelle eines SELECT-Statements an der Stelle von Werten oder Tabellen eine
weitere SELECT-Query einsetzen. Wenn ein einzelner Wert verlangt wird, muß
das eingesetzte SELECT ein skalares SELECT sein, also eine 1x1-Tabelle
zurück liefern.</p>
<p>Ein einfaches Beispiel:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">sum</span>(bid) <span style="color:#66d9ef">from</span> b;
<span style="color:#f92672">+</span><span style="color:#75715e">----------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">sum</span>(bid) <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>        <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)

root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> aid, ( 
<span style="color:#f92672">-&gt;</span>    <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">sum</span>(bid) <span style="color:#66d9ef">from</span> b ) <span style="color:#66d9ef">as</span> bsum 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> a;
<span style="color:#f92672">+</span><span style="color:#75715e">-----+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> aid <span style="color:#f92672">|</span> bsum <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>   <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">03</span> sec)
</code></pre></div><p>Hier ist als Teil der SELECT-Clause statt einer Konstanten oder eines
Spaltennamen ein skalares SELECT eingesetzt worden. Die Spalte bsum ist das
Ergebnis der Abfrage &ldquo;select sum(bid) from b&rdquo; und wird dort eingesetzt.</p>
<p>Auch in der FROM-Clause eines SELECT kann man SELECT-Statements einsetzen.
Diese Query zum Beispiel listet zu jedem Schema auf, wie viele Zeilen die
größte Tabelle in diesem Schema hat:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [test_world]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> 
<span style="color:#f92672">-&gt;</span>    table_schema, 
<span style="color:#f92672">-&gt;</span>    <span style="color:#66d9ef">max</span>(table_rows)
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> 
<span style="color:#f92672">-&gt;</span>    information_schema.tables 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> 
<span style="color:#f92672">-&gt;</span>    table_schema;
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+-----------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> table_schema       <span style="color:#f92672">|</span> <span style="color:#66d9ef">max</span>(table_rows) <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+-----------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> geodb              <span style="color:#f92672">|</span>          <span style="color:#ae81ff">459015</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> information_schema <span style="color:#f92672">|</span>            <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> kris               <span style="color:#f92672">|</span>               <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> mysql              <span style="color:#f92672">|</span>             <span style="color:#ae81ff">986</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test               <span style="color:#f92672">|</span>              <span style="color:#ae81ff">12</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_tablesizes    <span style="color:#f92672">|</span>              <span style="color:#ae81ff">79</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_world         <span style="color:#f92672">|</span>            <span style="color:#ae81ff">4079</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+-----------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">7</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">3</span>.<span style="color:#ae81ff">92</span> sec)
</code></pre></div><p>Wenn wir nun den Namen der Tabelle ermitteln wollen, die in diesem Schema
die meisten Zeilen hat, dann geht das unter anderem so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [test_world]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> tables <span style="color:#66d9ef">as</span> 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> information_schema.tables;
Query OK, <span style="color:#ae81ff">93</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">12</span> sec)
Records: <span style="color:#ae81ff">93</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

root<span style="color:#f92672">@</span>localhost [test_world]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> 
<span style="color:#f92672">-&gt;</span>    m.table_schema, 
<span style="color:#f92672">-&gt;</span>    t.<span style="color:#66d9ef">table_name</span>, 
<span style="color:#f92672">-&gt;</span>    m.maxrows 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> 
<span style="color:#f92672">-&gt;</span>    tables <span style="color:#66d9ef">as</span> t <span style="color:#66d9ef">join</span> 
<span style="color:#f92672">-&gt;</span>    (<span style="color:#66d9ef">select</span> table_schema, <span style="color:#66d9ef">max</span>(table_rows) <span style="color:#66d9ef">as</span> maxrows 
<span style="color:#f92672">-&gt;</span>    <span style="color:#66d9ef">from</span> tables <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> table_schema ) <span style="color:#66d9ef">as</span> m 
<span style="color:#f92672">-&gt;</span>        <span style="color:#66d9ef">on</span> t.table_rows <span style="color:#f92672">=</span> m.maxrows;
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+---------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> table_schema    <span style="color:#f92672">|</span> <span style="color:#66d9ef">table_name</span>     <span style="color:#f92672">|</span> maxrows <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+---------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> geodb           <span style="color:#f92672">|</span> geodb_textdata <span style="color:#f92672">|</span>  <span style="color:#ae81ff">466518</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> kris            <span style="color:#f92672">|</span> emp            <span style="color:#f92672">|</span>       <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> mysql           <span style="color:#f92672">|</span> help_relation  <span style="color:#f92672">|</span>     <span style="color:#ae81ff">986</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test            <span style="color:#f92672">|</span> h              <span style="color:#f92672">|</span>      <span style="color:#ae81ff">12</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> kris            <span style="color:#f92672">|</span> p              <span style="color:#f92672">|</span>       <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test            <span style="color:#f92672">|</span> t              <span style="color:#f92672">|</span>      <span style="color:#ae81ff">12</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_tablesizes <span style="color:#f92672">|</span> sizes          <span style="color:#f92672">|</span>      <span style="color:#ae81ff">79</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_world      <span style="color:#f92672">|</span> City           <span style="color:#f92672">|</span>    <span style="color:#ae81ff">4079</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+---------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">8</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>In einem ersten Schritt machen wir hier einen Snapshot von
information_schema.tables. Das ist nicht nur schneller, sondern es bewirkt
auch, daß wir statische Daten bekommen. Dadurch haben zwei aufeinander
folgende Anfragen an die Tabelle auch identische Werte - das ist bei
information_schema sonst nicht zwingend gegeben.</p>
<p>Die zweite Query setzt die Tabelle aus dem ersten Beispiel in der
FROM-Clause ein und joined sie gegen unseren information_schema Snapshot.
Wir fragen nun nach dem Schema und dem Namen der Tabelle, die dieselbe Größe
hat, wie das in der Subquery ermittelte Maximum. Es gibt viele Wege, um
dieses Problem &lsquo;Finde das gruppenweise Maximum&rsquo; zu lösen -
<a href="http://jan.kneschke.de/projects/mysql/groupwise-max/" target="_blank" rel="noopener">Jan Kneschke</a>

 hat eine
Übersicht.</p>
<p>Auch in einer WHERE-Clause können wir eine Subquery einbauen. Gemäß dem
Beispiel von Jan:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [test_world]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> 
<span style="color:#f92672">-&gt;</span>    t.table_schema, 
<span style="color:#f92672">-&gt;</span>    t.<span style="color:#66d9ef">table_name</span>, 
<span style="color:#f92672">-&gt;</span>    t.table_rows 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">from</span> 
<span style="color:#f92672">-&gt;</span>    tables <span style="color:#66d9ef">as</span> t 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">where</span> 
<span style="color:#f92672">-&gt;</span>    t.table_rows <span style="color:#f92672">=</span> ( 
<span style="color:#f92672">-&gt;</span>        <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">max</span>(table_rows) <span style="color:#66d9ef">as</span> maxrows 
<span style="color:#f92672">-&gt;</span>        <span style="color:#66d9ef">from</span> tables <span style="color:#66d9ef">as</span> m 
<span style="color:#f92672">-&gt;</span>        <span style="color:#66d9ef">where</span> 
<span style="color:#f92672">-&gt;</span>            t.table_schema <span style="color:#f92672">=</span> m.table_schema 
<span style="color:#f92672">-&gt;</span>    );
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> table_schema    <span style="color:#f92672">|</span> <span style="color:#66d9ef">table_name</span>     <span style="color:#f92672">|</span> table_rows <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> geodb           <span style="color:#f92672">|</span> geodb_textdata <span style="color:#f92672">|</span>     <span style="color:#ae81ff">466518</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> kris            <span style="color:#f92672">|</span> emp            <span style="color:#f92672">|</span>          <span style="color:#ae81ff">6</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> mysql           <span style="color:#f92672">|</span> help_relation  <span style="color:#f92672">|</span>        <span style="color:#ae81ff">986</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test            <span style="color:#f92672">|</span> h              <span style="color:#f92672">|</span>         <span style="color:#ae81ff">12</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test            <span style="color:#f92672">|</span> t              <span style="color:#f92672">|</span>         <span style="color:#ae81ff">12</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_tablesizes <span style="color:#f92672">|</span> sizes          <span style="color:#f92672">|</span>         <span style="color:#ae81ff">79</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> test_world      <span style="color:#f92672">|</span> City           <span style="color:#f92672">|</span>       <span style="color:#ae81ff">4079</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-----------------+----------------+------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">7</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Das liest sich als: Liste mir alle Tabellen mit ihrer Größe, bei denen die
Größe der maximalen Größe der Tabelle entspricht, die im selben Schema ist
wie die aktuelle Tabelle.</p>
<p>Weitere Anwendungsfälle von Subqueries finden sich im Beispiel von Jan und
<a href="http://dev.mysql.com/doc/refman/5.1/en/subqueries.html" target="_blank" rel="noopener">im Handbuch</a>

 - mir
geht es hier in erster Linie darum zu zeigen, wie die Algebra-Eigenschaft
von SQL das Weiterrechnen mit den Ergebnissen erlaubt.</p>
<h2 id="tupel-als-datentyp">
    <a href="#tupel-als-datentyp">
	Tupel als Datentyp
    </a>
</h2>
<p>Tabellen sind Mengen von Tupeln, und Tupel sind ein Datentyp in SQL, mit dem
man arbeiten kann. Mit der Tabelle</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t;
<span style="color:#f92672">+</span><span style="color:#75715e">------+-------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b     <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+-------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one   <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> zwei <span style="color:#f92672">|</span> two   <span style="color:#f92672">|</span> <span style="color:#ae81ff">2</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> drei <span style="color:#f92672">|</span> three <span style="color:#f92672">|</span> <span style="color:#ae81ff">3</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span> eins  <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+-------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">4</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>läßt sich die einfache Anfrage</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> a,b,<span style="color:#66d9ef">c</span> <span style="color:#66d9ef">from</span> t <span style="color:#66d9ef">where</span> a <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;eins&#39;</span> <span style="color:#66d9ef">and</span> b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;one&#39;</span>;
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b    <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>auch so schreiben:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> a,b,<span style="color:#66d9ef">c</span> <span style="color:#66d9ef">from</span> t <span style="color:#66d9ef">where</span> (a,b) <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;eins&#39;</span>,<span style="color:#e6db74">&#39;one&#39;</span>);
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b    <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Erweitert kann man auch nach mehr als einem Wert fragen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t <span style="color:#66d9ef">where</span> (a,b) <span style="color:#66d9ef">in</span> ((<span style="color:#e6db74">&#39;eins&#39;</span>,<span style="color:#e6db74">&#39;one&#39;</span>), (<span style="color:#e6db74">&#39;zwei&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>));
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b    <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> zwei <span style="color:#f92672">|</span> two  <span style="color:#f92672">|</span> <span style="color:#ae81ff">2</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Manchmal will man nach einem Wert in irgendeiner Spalte suchen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> a,b,<span style="color:#66d9ef">c</span> <span style="color:#66d9ef">from</span> t 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">where</span> <span style="color:#e6db74">&#39;eins&#39;</span> <span style="color:#66d9ef">in</span> (a,b,<span style="color:#66d9ef">c</span>);
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b    <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>ist &ldquo;Finde mir alle Zeilen, in denen in einer Spalte der Wert &lsquo;eins&rsquo;
vorkommt.&rdquo;. Auch das geht mit Tupeln. In diesem Fall will ich, daß &lsquo;eins&rsquo;
und &lsquo;one&rsquo; in benachbarten Spalten vorkommen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">root<span style="color:#f92672">@</span>localhost [kris]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> a,b,<span style="color:#66d9ef">c</span> <span style="color:#66d9ef">from</span> t 
<span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">where</span> (<span style="color:#e6db74">&#39;eins&#39;</span>,<span style="color:#e6db74">&#39;one&#39;</span>) <span style="color:#66d9ef">in</span> ((a,b),(b,<span style="color:#66d9ef">c</span>));
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> a    <span style="color:#f92672">|</span> b    <span style="color:#f92672">|</span> <span style="color:#66d9ef">c</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">1</span>    <span style="color:#f92672">|</span> eins <span style="color:#f92672">|</span> one  <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">------+------+------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>Leider ist MySQL nicht ganz konsequent mit der Umsetzung von Tupeln als
Datentyp: Man kann den Aufruf einer Stored Procedure (&lsquo;CALL blah()') nicht
in einer Subquery verwenden.</p>
<h2 id="abfragesprachen-die-keine-algebra-sind">
    <a href="#abfragesprachen-die-keine-algebra-sind">
	Abfragesprachen, die keine Algebra sind
    </a>
</h2>
<p>Viele Abfragesprachen existieren, die keine Algebra sind, bei denen also die
Ergebnisse nicht von der Art sind, daß man mit ihnen weiter rechnen könnte.</p>
<p>Ein klassisches Beispiel ist LDAP: LDAP definiert Operationen auf einem
Baum, dem LDAP-Baum. Das Ergebnis einer LDAP-Query ist jedoch kein Teilbaum,
sondern eine Knotenmenge. Diese kann mit LDAP-Operationen nicht weiter
verfeinert oder verarbeitet werden. Das Ergebnis: LDAP-Server sind zwar sehr
schnell und können zum Teil hunderttausende von Anfragen pro Sekunde
verarbeiten. Aber Dinge, die man in SQL mit einer Query erledigen könnte
brauchen in LDAP dann auch hunderttausende von Anfragen.</p>
<p>Ein weiteres klassisches Beispiel: XPath. XPath definiert ebenfalls einen
Baum als Datentyp und Operationen darauf. Das Ergebnis einer XPath-Query ist
jedoch ein Nodeset, kein Baum, kann also mit XPath auch nicht weiter
verarbeitet werden (aber XSLT ist sowieso so angelegt, daß der Zugriff auf
Ergebnisse zur Weiterverarbeitung mindestens stark erschwert wird, wenn
nicht sogar unmöglich gemacht wird).</p>
<p>In beiden Fällen schränkt sich die Abfragesprache in ihren Möglichkeiten
stark ein und erfordert dann mehr Code (und mehr Kommunikation, und damit
mehr Latenz) in der Hostsprache, in der sie eingebettet ist.</p>


	
    </article>
</div>



            <footer>
    <p>
	&copy; Copyright 2021 Someone or something
    </p>
</footer>


        </main>

	





<script src="/js/bootstrap.js"></script>




<script src="/js/lunr.js"></script>





<script src="/js/app.js"></script>


    </body>
</html>
