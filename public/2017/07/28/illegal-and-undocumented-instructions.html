<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Die wunderbare Welt von Isotopp - Illegal and undocumented instructions</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="site.webmanifest">
<link rel="apple-touch-icon" href="icon.png">
<link rel="favicon.ico" rel="icon" type="image/ico">





	



<link rel="stylesheet" href="/style.min.c5e5cd61f54911f9aafd1dbe09c2f90667957bfe1002126c87aace57759f3446.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
	<a class="navbar-brand" href="" rel="home" title=".Site.Title">
	    Die wunderbare Welt von Isotopp
	</a>
	<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
		
		
		<li class="nav-item ">
                    <a class="nav-link" href="/about/">
			
			<span>About</span>
			<span class="visually-hidden">(Current)</span>
		    </a>
		    
		</li>
            </ul>
            
	</div>
    </div>
</nav>


        <main role="main" class="container-fluid">

            


<div class="page">
    <article class="illegal-and-undocumented-instructions-page">
	<h1 class="title">
            Illegal and undocumented instructions
	</h1>

	<p><a href="http://www.pagetable.com/?p=39" target="_blank" rel="noopener"><p class="md__image">
  <img src="/uploads/2017/07/6502-die.jpg" alt=""  />
</p>

</a>

</p>
<p>Illegal and undocumented instructions are not a new thing. The Commodore 64
CPU, a 6502 with a few additional I/O lines, was known to have them. Since
on current CPUs we can completely VLSI simulate a 6502 in Javascript we also
understand where they come from.</p>
<p><a href="http://www.pagetable.com/?p=39" target="_blank" rel="noopener">Pagetable.com has a wonderful article on this</a>

.
So how about current CPUs? Modern CPUs are vastly bigger and more
complicated than a 6502, and they are also set up very differently. So
simulation is not taking us anywhere, but we can fuzz.
<a href="https://github.com/xoreaxeaxeax/sandsifter" target="_blank" rel="noopener">Sandsifter</a>

 is such a CPU
fuzzer: it generates every conceivable instruction byte
combination and then tries to observe what happens.</p>
<blockquote>
<p>Sandsifter has uncovered secret processor instructions from every major
vendor; ubiquitous software bugs in disassemblers, assemblers, and
emulators; flaws in enterprise hypervisors; and both benign and
security-critical hardware bugs in x86 chips.</p>
</blockquote>
<p>The findings have been summarized in a whitepaper
(<a href="https://github.com/xoreaxeaxeax/sandsifter/blob/master/references/domas_breaking_the_x86_isa_wp.pdf" target="_blank" rel="noopener">PDF</a>

),
which also describes how to effectively search the instruction space of a
CPU that has variable length instructions from 1 to 15 bytes in length.</p>
<p>A crafty way of using page faults to determine the length of privileged
instructions while running unprivileged is shown. The strategy implemented
reduces the search space from some 10E36 instructions down to about 100
million, which is a manageable size on modern CPUs. Known instructions
(things that some reference disassembler knows and correctly predicts) are
eliminated, the rest is interesting and deserves attention.</p>


	
    </article>
</div>



            <footer>
    <p>
	&copy; Copyright 2021 Someone or something
    </p>
</footer>


        </main>

	





<script src="/js/bootstrap.js"></script>




<script src="/js/lunr.js"></script>





<script src="/js/app.js"></script>


    </body>
</html>
