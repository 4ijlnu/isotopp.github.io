<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Die wunderbare Welt von Isotopp - Rechenaufgaben lösen</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="site.webmanifest">
<link rel="apple-touch-icon" href="icon.png">
<link rel="favicon.ico" rel="icon" type="image/ico">





	



<link rel="stylesheet" href="/style.min.c5e5cd61f54911f9aafd1dbe09c2f90667957bfe1002126c87aace57759f3446.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
	<a class="navbar-brand" href="" rel="home" title=".Site.Title">
	    Die wunderbare Welt von Isotopp
	</a>
	<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
		
		
		<li class="nav-item ">
                    <a class="nav-link" href="/about/">
			
			<span>About</span>
			<span class="visually-hidden">(Current)</span>
		    </a>
		    
		</li>
            </ul>
            
	</div>
    </div>
</nav>


        <main role="main" class="container-fluid">

            


<div class="page">
    <article class="rechenaufgaben-l%C3%B6sen-page">
	<h1 class="title">
            Rechenaufgaben lösen
	</h1>

	<p>Das Kind möchte ein Programm zum Üben von Rechenaufgaben sehen. Nun gut. Hier ist eine Version in PyQt5.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-01.png" alt=""  />
</p>

</p>
<p><em>Unsere Oberfläche soll so aussehen.</em></p>
<p>Wir wollen ein kleines Fenster, in dem eine billig generierte Rechenaufgabe angezeigt wird. Der Schüler soll die Antwort eingeben und den Knopf &ldquo;Antworten&rdquo; drücken. Danach wird angesagt, ob die Antwort korrekt war, oder ob sie falsch war. Wenn sie falsch war, wird auch die korrekte Antwort angezeigt.</p>
<p>In der Statuszeile und in den Fortschrittbalken wird ein laufender Score mitgeführt. Nach 10 Aufgaben, oder wenn man &ldquo;Quit&rdquo; drückt, wird das Programm beendet.</p>
<h2 id="das-userinterface-gestalten">
    <a href="#das-userinterface-gestalten">
	Das Userinterface gestalten
    </a>
</h2>
<p>Wir brauchen Qt Designer, und erzeugen dort ein MainWindow.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-02.png" alt=""  />
</p>

</p>
<p><em>MainWindow erzeugen.</em></p>
<p>Mit einem Rechtsklick auf die Menubar und &ldquo;Remove Menubar&rdquo; können wir die nicht verwendete Menubar entfernen. Die kaum erkennbare Statusbar unten im Fenster lassen wir stehen.</p>
<p>Wir sehen rechts die im Programm vorhandene Bedienelemente-Hierarchie im Qt Designer. Das automatisch erzeugte &ldquo;Centralwidget&rdquo; ist leer, und hat einen Fehler (es ist mit einem roten Kuller markiert): Es hat noch kein Layout. Das Layout ordnet die im Centralwidget vorhandenen Unterelemente an.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-03.png" alt=""  />
</p>

</p>
<p><em>Das Centralwidget ist mit einem roten Kuller als &ldquo;ohne Layout&rdquo; markiert.</em></p>
<p>Wir ziehen einen QPushbutton in das Fenster, und drücken im gepunkteten Hintergrund die rechte Maustaste, wählen dann ein VerticalLayout aus.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-04.png" alt=""  />
</p>

</p>
<p><em>Nachdem mindestens ein Bedienelement im Centralwidget vorhanden ist, kann man mit der rechten Maustaste im Layout-Submenü ganz unten ein Layout auswählen.</em></p>
<p>Nach dem Zuweisen eines Layouts verschwindet der rote Kuller und die Elemente im Centralwidget ordnen sich an.</p>
<p>Wir setzen oberhalb des Buttons ein weiteres Element ein: Eine groupBox. Auch diese hat ein Layoutproblem: Wir setzen einen weiteren Button ein und wählen ebenso durch Rechtsklick ins Leere der Groupbox ein HorizontalLayout aus.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-05.png" alt=""  />
</p>

</p>
<p><em>Wir haben oberhalb des ersten Buttons eine Groupbox positioniert, und sie passt sich automatisch an das Fenster an - das ist das VerticalLayout vom Centralwidget bei der Arbeit. Legen wir in die Groupbox einen weiteren QPushbutton, können wir der Groupbox ebenfalls ein Layout zuweisen. Hier wollen wir ein HorizontalLayout verwenden.</em></p>
<p>Nachdem wir diese Grundstruktur haben, können wir die anderen fehlenden Elemente schnell nachziehen. Dabei ist wichtig, daß wir für jedes Element den passenden Namen festlegen, unter dem es später im Programm aufgerufen werden soll.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-06.png" alt=""  />
</p>

</p>
<p><em>Jedes Element hat einen Namen - rechts kann man die Widgethierarchie sehen, und die Namen, die wir den Elementen zugewiesen haben.</em></p>
<p>Nachdem wir Elemente korrekt benannt haben, müssen wir noch die Beschriftungen der Knöpfe und anderen Elemente anpassen. Dazu reicht es, den Knopf zu doppelklicken und den Text zu ersetzen.</p>
<p>Weiterhin kann man in den Widget-Eigenschaften bei einigen Elementen die Schriftgrößen anpassen. Ich habe <code>a</code>, <code>+</code>, <code>b</code> und <code>=</code> sowie den <code>Richtig oder falsch?</code>-Text von 8 auf 12 Punkt Schriftgröße angepasst.</p>
<p>Am Ende wird die Datei als &ldquo;aufgaben.ui&rdquo; abgespeichert. Ich habe sie direkt dem PyCharm Projekt hinzugefügt.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-07.png" alt=""  />
</p>

</p>
<p><em>Die Qt Designer Ausgabe &ldquo;aufgaben.ui&rdquo; wird Bestandteil des PyCharm Projektes.</em></p>
<h2 id="pycharm-basisprojekt">
    <a href="#pycharm-basisprojekt">
	PyCharm Basisprojekt
    </a>
</h2>
<p>Wir setzen ein Basisprogram mit Python 3.8 in PyCharm auf, und fügen die &ldquo;aufgaben.ui&rdquo; unserem Projekt hinzu. Unser Programm soll &ldquo;aufgaben.py&rdquo; heißen. Es wird PyQt5 verwenden, also schreiben wir das in unsere &ldquo;requirements.txt&rdquo;. PyCharm installiert uns das dann in unser venv.</p>
<p><p class="md__image">
  <img src="/uploads/2021/02/aufgaben-08.png" alt=""  />
</p>

</p>
<p><em>Wenn die Requirements korrekt installiert sind, funktioniert das Importieren der QtWidgets in der Python Console einwandfrei und ohne Fehler.</em></p>
<p>Wir können die UI-Datei jetzt laden und ausführen, aber unser Programm wird dann noch nichts tun:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> PyQt5 <span style="color:#f92672">import</span> QtWidgets, uic
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ui</span>(QtWidgets<span style="color:#f92672">.</span>QMainWindow):
    button_quit: QtWidgets<span style="color:#f92672">.</span>QPushButton

    group_aufgabe: QtWidgets<span style="color:#f92672">.</span>QGroupBox

    label_a: QtWidgets<span style="color:#f92672">.</span>QLabel
    label_b: QtWidgets<span style="color:#f92672">.</span>QLabel
    label_op: QtWidgets<span style="color:#f92672">.</span>QLabel
    button_loesen: QtWidgets<span style="color:#f92672">.</span>QPushButton
    feld_antwort: QtWidgets<span style="color:#f92672">.</span>QLineEdit

    label_richtig: QtWidgets<span style="color:#f92672">.</span>QLabel
    fortschritt_richtig: QtWidgets<span style="color:#f92672">.</span>QProgressBar
    fortschritt_total: QtWidgets<span style="color:#f92672">.</span>QProgressBar

    statusbar: QtWidgets<span style="color:#f92672">.</span>QStatusBar

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_ui</span>(self) <span style="color:#f92672">-&gt;</span> None:
        uic<span style="color:#f92672">.</span>loadUi(<span style="color:#e6db74">&#34;aufgaben.ui&#34;</span>, self)

        self<span style="color:#f92672">.</span>button_quit <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_quit&#34;</span>)

        self<span style="color:#f92672">.</span>group_aufgabe <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QGroupBox, <span style="color:#e6db74">&#34;group_aufgabe&#34;</span>)

        self<span style="color:#f92672">.</span>label_a <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QLabel, <span style="color:#e6db74">&#34;label_a&#34;</span>)
        self<span style="color:#f92672">.</span>label_b <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QLabel, <span style="color:#e6db74">&#34;label_b&#34;</span>)
        self<span style="color:#f92672">.</span>label_op <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QLabel, <span style="color:#e6db74">&#34;label_op&#34;</span>)
        self<span style="color:#f92672">.</span>button_loesen <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_loesen&#34;</span>)

        self<span style="color:#f92672">.</span>label_richtig <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QLabel, <span style="color:#e6db74">&#34;label_richtig&#34;</span>)
        self<span style="color:#f92672">.</span>fortschritt_richtig <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QProgressBar, <span style="color:#e6db74">&#34;fortschritt_richtig&#34;</span>)
        self<span style="color:#f92672">.</span>fortschritt_total <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QProgressBar, <span style="color:#e6db74">&#34;fortschritt_total&#34;</span>)

        self<span style="color:#f92672">.</span>statusbar <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QStatusBar, <span style="color:#e6db74">&#34;statusbar&#34;</span>)

        self<span style="color:#f92672">.</span>feld_antwort <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QLineEdit, <span style="color:#e6db74">&#34;feld_antwort&#34;</span>)

    <span style="color:#66d9ef">def</span> __init__(self):
        super(Ui, self)<span style="color:#f92672">.</span>__init__()

        self<span style="color:#f92672">.</span>load_ui()
        self<span style="color:#f92672">.</span>show()


app <span style="color:#f92672">=</span> QtWidgets<span style="color:#f92672">.</span>QApplication(sys<span style="color:#f92672">.</span>argv)
window <span style="color:#f92672">=</span> Ui()
app<span style="color:#f92672">.</span><span style="color:#66d9ef">exec</span>()
</code></pre></div><p>Das Programm importiert <code>QtWidgets</code> und <code>uic</code> aus dem <code>PtQt5</code> Package. Es definiert eine Klasse <code>Ui</code> als Unterklasse von <code>QtWidgets.QMainWindow</code>. Wir definieren eine Methode <code>load_ui()</code>, die die <code>aufgaben.ui</code>-Datei lädt. Im Konstruktor initialisieren wir die Superklasse (das QMainWindow) und rufen dann <code>load_ui()</code> auf. Mit <code>.show()</code> werden die Bedienlemente dann auch sichtbar.</p>
<p>Das Hauptprogramm hat die typische Minimalform für eine Qt-Anwendung: Erzeuge ein <code>QApplication</code>-Objekt, erzeuge unser <code>QMainWindow</code> (eigentlich eine Instanz unserer von <code>QMainWindow</code> abgeleiteten Klasse <code>Ui</code>) und starte dann die Event-Loop mit <code>app.exec()</code>.</p>
<p>In unserer <code>Ui</code> Klasse definieren wir einen Haufen Slots für alle diejenigen  Bedienelemente der <code>.ui</code>-Datei, die wir direkt ansprechen wollen. In der <code>load_ui()</code>-Methode durchsuchen wir die <code>.ui</code>-Datei mit <code>.findChild()</code> nach diesen Elementen und merken sie uns in diesen Slots.</p>
<p>Wir können gleich noch den Quit-Button aktivieren: Aus</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">        self<span style="color:#f92672">.</span>button_quit <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_quit&#34;</span>)
</code></pre></div><p>wird</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">        self<span style="color:#f92672">.</span>button_quit <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_quit&#34;</span>)
        self<span style="color:#f92672">.</span>button_quit<span style="color:#f92672">.</span>clicked<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>quit_pressed)
</code></pre></div><p>und wir fügen der <code>Ui</code>-Klasse eine Methode <code>quit_pressed()</code> hinzu:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit_pressed</span>(self) <span style="color:#f92672">-&gt;</span> None:
        msg: QtWidgets<span style="color:#f92672">.</span>QMessageBox <span style="color:#f92672">=</span> QtWidgets<span style="color:#f92672">.</span>QMessageBox()
        msg<span style="color:#f92672">.</span>setText(<span style="color:#e6db74">&#34;Auf Wiedersehen.&#34;</span>)
        msg<span style="color:#f92672">.</span>setWindowTitle(<span style="color:#e6db74">&#34;Auf Wiedersehen.&#34;</span>)
        msg<span style="color:#f92672">.</span>setStandardButtons(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Ok)
        msg<span style="color:#f92672">.</span>setDefaultButton(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Ok)
        msg<span style="color:#f92672">.</span>setIcon(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Information)
        msg<span style="color:#f92672">.</span><span style="color:#66d9ef">exec</span>()
        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</code></pre></div><p>Dies ist zugleich ein Beispiel für das Erzeugen von PyQt5-Elementen ohne QtDesigner: Wir hätten diesen Dialog auch mit dem Designer in eine <code>.ui</code>-Datei speichern können, um sie dann mit <code>uic</code> zu laden. Stattdessen erzeugen wir hier den Abschiedsdialog manuell und rufen ihn dann auf, bevor wir das Programm beenden.</p>
<p>Dieses Teilprogramm ist nun schon lauffähig und zeigt das funktionsfähige Programm mit User-Interface an. Es tut jedoch noch nichts.</p>
<h2 id="aufgaben-generieren">
    <a href="#aufgaben-generieren">
	Aufgaben generieren
    </a>
</h2>
<p>Um Rechenaufgaben zu erzeugen und dann feststellen zu können, ob jemand sie richtig ausgerechnet hat, brauchen wir eine Klasse <code>Aufgabe</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> randint, choice
<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Aufgabe</span>:
    op: str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    a: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    b: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

    loesung: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

    allops: List[str]

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ausdenken</span>(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>op <span style="color:#f92672">=</span> choice(self<span style="color:#f92672">.</span>allops)
        self<span style="color:#f92672">.</span>a <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
        self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> randint(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>a <span style="color:#f92672">&lt;</span> self<span style="color:#f92672">.</span>b:
            self<span style="color:#f92672">.</span>a, self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>b, self<span style="color:#f92672">.</span>a

        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>op <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;+&#34;</span>:
            self<span style="color:#f92672">.</span>loesung <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>a <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>b
        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>op <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;-&#34;</span>:
            self<span style="color:#f92672">.</span>loesung <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>a <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>b

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pruefen</span>(self, loesung: int) <span style="color:#f92672">-&gt;</span> bool:
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>loesung <span style="color:#f92672">==</span> loesung

    <span style="color:#66d9ef">def</span> __init__(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>allops <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;+&#34;</span>, <span style="color:#e6db74">&#34;-&#34;</span>]
        self<span style="color:#f92672">.</span>ausdenken()
</code></pre></div><p>Die Aufgabe hat die Variablen <code>a</code>, <code>b</code> und <code>op</code>, wobei <code>a</code> und <code>b</code> zwei Zahlen zwischen 1 und 10 sein sollen, und <code>op</code> entweder <code>+</code> oder <code>-</code> sein soll. Um die Subtraktion einfacher zu machen soll <code>a</code> die Größere der beiden Zahlen sein. In der Variablen <code>loesung</code> wollen wir uns die korrekte Lösung der Aufgabe merken.</p>
<p>Wir definieren uns einen Konstruktor, in dem wir auch die Liste der zugelassenen Operatoren in <code>allops</code> vorbelegen: Es ist eine Liste von Strings mit zwei Einträgen: Plus und Minus. Wir rufen von dort auch schon einmal die Methode <code>ausdenken()</code> auf, die sich eine neue Aufgabe ausdenkt.</p>
<p>In <code>ausdenken</code> bestimmen wir eine Operation (Plus oder Minus) durch zufällige Auswahl eines Elementes aus der Liste mit <code>choice()</code> und bestimmen zwei zufällige ganze Zahlen aus dem gewünschen Bereich mit <code>randint()</code>. Falls <code>a</code> die kleinere der beiden Zahlen ist, vertauschen wir sie.</p>
<p>Danach wird die Variable <code>loesung</code> korrekt belegt, in Abhängigkeit vom Operator <code>op</code>.</p>
<p>Das Prädikat <code>pruefen(loesung)</code> teilt uns mit, ob die vom Benutzer eingegebene Lösung korrekt ist.</p>
<h2 id="den-spielstand-mitführen">
    <a href="#den-spielstand-mitf%c3%bchren">
	Den Spielstand mitführen
    </a>
</h2>
<p>Der Benutzer kann nun Aufgaben bekommen und diese lösen. Wir können auch schon feststellen, ob diese Lösung korrekt ist. Wir brauchen aber noch Logik, die die Aufgaben zählt, die korrekten Aufgaben zählt und die uns sagt, ob wir fertig sind.</p>
<p>Wir brauchen <code>Score</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Score</span>:
    score: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    counter: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    target: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">correct</span>(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        self<span style="color:#f92672">.</span>score <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">incorrect</span>(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">done</span>(self) <span style="color:#f92672">-&gt;</span> bool:
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>counter <span style="color:#f92672">&gt;=</span> self<span style="color:#f92672">.</span>target

    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        self<span style="color:#f92672">.</span>counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        self<span style="color:#f92672">.</span>target <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</code></pre></div><p>Die Klasse zählt in <code>score</code> die korrekten Lösungen mit, in <code>counter</code> werden alle gelösten Aufgaben mitgezählt und in <code>target</code> speichern wir, wie viele Aufgabenrunden das Spiel insgesamt dauert.</p>
<p>Die Methode <code>correct()</code> wird aufgerufen, wenn der Benutzer eine richtige Antwort eingegeben hat: Wir zählen dann <code>counter</code> und <code>score</code> gemeinsam hoch. Bei <code>incorrect()</code> wird dagegen nur der <code>counter</code> weiter gezählt. Das Prädikat <code>done()</code> sagt uns, ob das Spiel beendet werden kann, weil genug Aufgaben gelöst worden sind.</p>
<h2 id="aufgaben-und-score-verkabeln">
    <a href="#aufgaben-und-score-verkabeln">
	Aufgaben und Score verkabeln
    </a>
</h2>
<p>Wir verändern jetzt den Konstruktor unserer Hauptklasse <code>Ui</code>: Dort wollen wir auch einen Score und eine Aufgabe erzeugen. Und statt <code>show()</code> direkt aufzurufen haben wir jetzt eine Methode <code>alles_updaten()</code>, die die Texte der verschiedenen Bedienelemente verändert und dann erst <code>show()</code> aufruft.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ui</span>(QtWidgets<span style="color:#f92672">.</span>QMainWindow):
    aufgabe: Aufgabe
    score: Score

<span style="color:#f92672">...</span>

    <span style="color:#66d9ef">def</span> __init__(self):
        super(Ui, self)<span style="color:#f92672">.</span>__init__()
        self<span style="color:#f92672">.</span>score <span style="color:#f92672">=</span> Score()
        self<span style="color:#f92672">.</span>aufgabe <span style="color:#f92672">=</span> Aufgabe()

        self<span style="color:#f92672">.</span>load_ui()
        self<span style="color:#f92672">.</span>alles_updaten()
</code></pre></div><p>Und <code>alles_updaten()</code> sieht nun so aus:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_aufgabe</span>(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>label_a<span style="color:#f92672">.</span>setText(str(self<span style="color:#f92672">.</span>aufgabe<span style="color:#f92672">.</span>a))
        self<span style="color:#f92672">.</span>label_op<span style="color:#f92672">.</span>setText(str(self<span style="color:#f92672">.</span>aufgabe<span style="color:#f92672">.</span>op))
        self<span style="color:#f92672">.</span>label_b<span style="color:#f92672">.</span>setText(str(self<span style="color:#f92672">.</span>aufgabe<span style="color:#f92672">.</span>b))

        title <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;Aufgabe {self.score.counter+1}/{self.score.target}&#34;</span>
        self<span style="color:#f92672">.</span>group_aufgabe<span style="color:#f92672">.</span>setTitle(title)

        self<span style="color:#f92672">.</span>fortschritt_richtig<span style="color:#f92672">.</span>setValue(self<span style="color:#f92672">.</span>score<span style="color:#f92672">.</span>score)
        self<span style="color:#f92672">.</span>fortschritt_total<span style="color:#f92672">.</span>setValue(self<span style="color:#f92672">.</span>score<span style="color:#f92672">.</span>counter)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">set_statusbar</span>(self) <span style="color:#f92672">-&gt;</span> None:
        status <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;Aufgabe {self.score.counter}/{self.score.target}, {self.score.score} richtig.&#34;</span>
        self<span style="color:#f92672">.</span>statusbar<span style="color:#f92672">.</span>showMessage(status)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">alles_updaten</span>(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>set_statusbar()
        self<span style="color:#f92672">.</span>set_aufgabe()
        self<span style="color:#f92672">.</span>show()
</code></pre></div><p>Wir aktualisieren also das <code>statusbar</code> Element in <code>set_statusbar()</code> und die Aufgabenanzeige in der Groupbox in <code>set_aufgabe()</code>.</p>
<p>In <code>set_statusbar()</code> erzeugen wir den gewünschten Text durch Auslesen des Score und rufen dann <code>showMessage()</code> für die Statusbar auf.</p>
<p>In <code>set_aufgabe()</code> verändern wir die Labeltexte von <code>label_a</code>, <code>label_op</code> und <code>label_b</code> durch Aufruf ihrer <code>setText()</code>-Methoden. Wir aktualisieren den Titel der Groupbox durch den Aufruf von <code>setTitle()</code> in der Groupbox, und wir setzen die beiden Fortschrittsbalken so, daß sie die Werte aus dem Score korrekt übernehmen. Das macht die Methode <code>setValue</code> der ProgressBar.</p>
<p>Jetzt haben wir ein Programm, das nicht nur die UI lädt und anzeigt, sondern auch schon eine Aufgabe ausdenkt und korrekt anzeigt.</p>
<h2 id="benutzereingabe-und-reaktion">
    <a href="#benutzereingabe-und-reaktion">
	Benutzereingabe und Reaktion
    </a>
</h2>
<p>Wir müssen jetzt auf Benutzereingaben reagieren. Das passiert, sobald der Benutzer den Knopf &ldquo;Antworten&rdquo; betätigt. Wir brauchen also eine Methode <code>auswerten()</code> in <code>Ui</code> und müssen diese mit dem Knopf verbinden.</p>
<p>Wir wollen ausdrücklich nicht, daß beim Verlassen der Editbox etwas passiert - nur der Knopf soll Funktionen auslösen. Darum verkabeln wir <code>feld_antwort</code> nicht direkt (wir könnten <a href="https://doc.qt.io/qt-5/qlineedit.html" target="_blank" rel="noopener">editingFinished()</a>

 verkabeln, wenn wir das wollten).</p>
<p>Die Methode:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">auswerten</span>(self) <span style="color:#f92672">-&gt;</span> None:
        loesung: int
        text: str

        text <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>feld_antwort<span style="color:#f92672">.</span>text()
        <span style="color:#66d9ef">if</span> text <span style="color:#f92672">is</span> None <span style="color:#f92672">or</span> text <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>:
            <span style="color:#66d9ef">return</span>

        <span style="color:#66d9ef">try</span>:
            loesung <span style="color:#f92672">=</span> int(text)
        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ValueError</span>:
            <span style="color:#66d9ef">return</span>

        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>aufgabe<span style="color:#f92672">.</span>pruefen(loesung):
            self<span style="color:#f92672">.</span>score<span style="color:#f92672">.</span>correct()
            ergebnis <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;Deine Lösung: {loesung}. Das war richtig.&#34;</span>
        <span style="color:#66d9ef">else</span>:
            self<span style="color:#f92672">.</span>score<span style="color:#f92672">.</span>incorrect()
            ergebnis <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;Deine Lösung: {loesung}. Richtig wäre: {self.aufgabe.loesung}.&#34;</span>

        self<span style="color:#f92672">.</span>label_richtig<span style="color:#f92672">.</span>setText(ergebnis)
        self<span style="color:#f92672">.</span>feld_antwort<span style="color:#f92672">.</span>setText(<span style="color:#e6db74">&#34;&#34;</span>)
        self<span style="color:#f92672">.</span>alles_updaten()

        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>score<span style="color:#f92672">.</span>done():
            self<span style="color:#f92672">.</span>quit_pressed()
        <span style="color:#66d9ef">else</span>:
            self<span style="color:#f92672">.</span>aufgabe<span style="color:#f92672">.</span>ausdenken()
            self<span style="color:#f92672">.</span>alles_updaten()
}

</code></pre></div><p>Wir lesen die Benutzeringabe aus dem Antwortfeld mit <code>text()</code> aus. Sie kann leer sein, dann ignorieren wir sie.</p>
<p>Danach versuchen wir diese Eingabe in eine ganze Zahl umzuwandeln. Wenn das nicht gelingt, ignorieren wir die Eingabe ebenfalls.</p>
<p>Schließlich rufen wir <code>pruefung()</code> in unserer Aufgabe-Klasse auf. Wenn die Antwort richtig war, erzeugen wir einen passenden Ausgabestring und zählen den Score als <code>correct()</code>. War sie falsch, erzeugen wir den anderen Ausgabestring und zählen den Score als <code>incorrect()</code>.</p>
<p>In jedem Fall setzen wir den Ausgabestring in das Label <code>label_richtig</code> und löschen das Eingabefeld. Danach aktualisieren wir das Userinterface durch Aufruf von <code>alles_updaten()</code>.</p>
<p>Falls der Benutzer ausreichend viele Aufgaben gelöst hat, beenden wir das Programm als wäre Quit gedrückt worden. Andernfalls denken wir uns eine neue Aufgabe aus und zeigen sie an.</p>
<p>Der Knopf &ldquo;Antworten&rdquo; muß nun ebenfalls verkabelt werden: In <code>load_ui()</code> passen wir die Zeile</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">        self<span style="color:#f92672">.</span>button_loesen <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_loesen&#34;</span>)
</code></pre></div><p>also zu</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">        self<span style="color:#f92672">.</span>button_loesen <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>findChild(QtWidgets<span style="color:#f92672">.</span>QPushButton, <span style="color:#e6db74">&#34;button_loesen&#34;</span>)
        self<span style="color:#f92672">.</span>button_loesen<span style="color:#f92672">.</span>clicked<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>auswerten)
</code></pre></div><p>an.</p>
<h2 id="fertig">
    <a href="#fertig">
	Fertig!
    </a>
</h2>
<p>Schließlich können wir in <code>quit_pressed()</code> noch die Dialognachricht anpassen, um einen Endscore anzuzeigen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit_pressed</span>(self) <span style="color:#f92672">-&gt;</span> None:
        msg: QtWidgets<span style="color:#f92672">.</span>QMessageBox <span style="color:#f92672">=</span> QtWidgets<span style="color:#f92672">.</span>QMessageBox()
        msg<span style="color:#f92672">.</span>setText(
            f<span style="color:#e6db74">&#34;Von {self.score.counter} Aufgaben waren {self.score.score} richtig.&#34;</span>
        )
        msg<span style="color:#f92672">.</span>setWindowTitle(<span style="color:#e6db74">&#34;Endergebnis&#34;</span>)
        msg<span style="color:#f92672">.</span>setStandardButtons(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Ok)
        msg<span style="color:#f92672">.</span>setDefaultButton(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Ok)
        msg<span style="color:#f92672">.</span>setIcon(QtWidgets<span style="color:#f92672">.</span>QMessageBox<span style="color:#f92672">.</span>Information)
        msg<span style="color:#f92672">.</span><span style="color:#66d9ef">exec</span>()
        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</code></pre></div><p>Nach dem Starten kann der Benutzer jetzt Aufgaben sehen, eine Lösung eingeben und den Knopf &ldquo;Antworten&rdquo; drücken. Das Programm wertet die Eingabe aus, zählt die Ergebnisse und bewegt die Fortschrittbalken. Nach 10 Eingaben gibt es ein Endergebnis aus und beendet sich.</p>
<p>Der vollständige Quelltext ist <a href="https://github.com/isotopp/pyqtaufgaben" target="_blank" rel="noopener">auf Github zu finden</a>

.</p>


	
    </article>
</div>



            <footer>
    <p>
	&copy; Copyright 2021 Someone or something
    </p>
</footer>


        </main>

	





<script src="/js/bootstrap.js"></script>




<script src="/js/lunr.js"></script>





<script src="/js/app.js"></script>


    </body>
</html>
