<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Die wunderbare Welt von Isotopp - MySQL 5.6.7-RC: GTID vs. MyISAM</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="site.webmanifest">
<link rel="apple-touch-icon" href="icon.png">
<link rel="favicon.ico" rel="icon" type="image/ico">





	



<link rel="stylesheet" href="/style.min.c5e5cd61f54911f9aafd1dbe09c2f90667957bfe1002126c87aace57759f3446.css">


    </head>
    <body>
        

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
	<a class="navbar-brand" href="" rel="home" title=".Site.Title">
	    Die wunderbare Welt von Isotopp
	</a>
	<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
		
		
		<li class="nav-item ">
                    <a class="nav-link" href="/about/">
			
			<span>About</span>
			<span class="visually-hidden">(Current)</span>
		    </a>
		    
		</li>
            </ul>
            
	</div>
    </div>
</nav>


        <main role="main" class="container-fluid">

            


<div class="page">
    <article class="mysql-5.6.7-rc-gtid-vs.-myisam-page">
	<h1 class="title">
            MySQL 5.6.7-RC: GTID vs. MyISAM
	</h1>

	<p>So we tested the 5.6.7-RC. And ran into a strange problem:</p>
<p>Because of a test, a preexisting configuration with GTID enabled existed,
and suddenly we did not have properly initialized grants in mysql.* created
for a new installation.  Turns out: GTID and non-transactional tables are no
friends, and that is even
<a href="http://dev.mysql.com/doc/refman/5.6/en/replication-gtids-restrictions.html" target="_blank" rel="noopener">documented</a>

.</p>
<blockquote>
<p>When using GTIDs, updates to tables using nontransactional storage engines
such as MyISAM are not supported.  This is because updates to such tables
mixed with updates to tables that use a transactional storage engine such
as InnoDB can result in multiple GTIDs being assigned to the same
transaction.</p>
</blockquote>
<p>Also, this is supposed to work with GRANT and REVOKE, but not with INSERT
and DELETE.  Now guess what mysql-install-db and friends are using?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">server:<span style="color:#f92672">~</span> <span style="color:#f92672">#</span> <span style="color:#66d9ef">less</span> <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span><span style="color:#66d9ef">share</span><span style="color:#f92672">/</span>mysql<span style="color:#f92672">/</span>mysql_system_tables_data.<span style="color:#66d9ef">sql</span>
...
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> tmp_user <span style="color:#66d9ef">VALUES</span> (<span style="color:#e6db74">&#39;localhost&#39;</span>,<span style="color:#e6db74">&#39;root&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>,...);
</code></pre></div><p>This is a larger problem: We are supposed to use GRANT and REVOKE, but many
people are using INSERT and DELETE in mysql.* all of the time, and so do
many applications.  And the mysql.* tables are MyISAM, and always have been
(except that nowadays there is a wild mix of CSV and InnoDB tables in there
as well).</p>
<p>MySQL cannot really ship GTID as a feature with MyISAM-tables in mysql.*
and expect that to work anywhere.  This is all very extremely broken and
needs urgent fixing.</p>
<p>This is now support-case SR 3-6270525721: &ldquo;MySQL 5.6.7-rc1, grants,
replication and GTID cause problems&rdquo; and will also soon have a bug number.
And, no, fixing the mysql_system_tables_data.sql is not really removing the
problem here.</p>


	
    </article>
</div>



            <footer>
    <p>
	&copy; Copyright 2021 Someone or something
    </p>
</footer>


        </main>

	





<script src="/js/bootstrap.js"></script>




<script src="/js/lunr.js"></script>





<script src="/js/app.js"></script>


    </body>
</html>
